# CVE-2016-0752: Directory Traversal Vulnerability in Action View

## Vulnerability Overview

**CVE ID:** CVE-2016-0752  
**Severity:** HIGH (CVSS 7.5)  
**Component:** Action View (Ruby on Rails)  
**Vulnerability Type:** Directory Traversal / Path Traversal

## Description

A directory traversal vulnerability exists in Action View, a component of Ruby on Rails. This vulnerability allows remote attackers to read arbitrary files on the server by exploiting an application's unrestricted use of the `render` method and providing `..` (dot dot) sequences in a pathname.

## Affected Versions

The following versions of Action View are vulnerable:

- All versions before **3.2.22.1**
- Version **4.0.x** and **4.1.x** before **4.1.14.1**
- Version **4.2.x** before **4.2.5.1**

## Patched Versions

The vulnerability has been patched in the following versions:

- **3.2.22.1** and later
- **4.1.14.1** and later
- **4.2.5.1** and later
- **5.0.0.beta1.1** and later

## Exploitation Example

An attacker can exploit this vulnerability by crafting a malicious request:

```ruby
# Vulnerable code example
def show
  render params[:template]
end
```

Malicious request:
```
GET /controller/show?template=../../../../etc/passwd
```

This would allow the attacker to read the `/etc/passwd` file or any other file accessible to the Rails application.

## Demonstration in This Repository

This repository contains a vulnerable `Gemfile` that specifies Rails 4.2.5, which includes the vulnerable version of Action View (4.2.5). This is intentionally included for:

- Security testing and training
- Vulnerability scanner validation
- DevSecOps pipeline testing
- Educational purposes

## Mitigation

### 1. Update Action View

Update to a patched version of Rails/Action View:

```ruby
# Gemfile - SECURE VERSION
gem 'rails', '~> 4.2.11.3'  # or later
# OR
gem 'rails', '~> 5.2.8.1'   # or later
# OR
gem 'rails', '~> 6.1.7.3'   # or later
# OR
gem 'rails', '~> 7.0.4.3'   # or latest stable
```

### 2. Input Validation

Never pass user-controlled input directly to `render`:

```ruby
# BAD - Vulnerable
def show
  render params[:template]
end

# GOOD - Safe
def show
  allowed_templates = ['template1', 'template2', 'template3']
  template = params[:template]
  
  if allowed_templates.include?(template)
    render template
  else
    render plain: 'Invalid template', status: :bad_request
  end
end
```

### 3. Use Whitelisting

Always whitelist allowed templates:

```ruby
ALLOWED_TEMPLATES = {
  'home' => 'pages/home',
  'about' => 'pages/about',
  'contact' => 'pages/contact'
}.freeze

def show
  template_key = params[:template]
  if ALLOWED_TEMPLATES.key?(template_key)
    render ALLOWED_TEMPLATES[template_key]
  else
    head :not_found
  end
end
```

## Detection

This vulnerability can be detected by:

1. **Dependency Scanners:**
   - Bundler Audit: `bundle audit`
   - Snyk
   - Dependabot
   - GitHub Security Advisories

2. **Security Scanning Tools:**
   - OWASP ZAP
   - Burp Suite
   - Acunetix
   - Qualys

3. **Code Analysis:**
   - Brakeman (Rails security scanner)
   - CodeQL
   - Semgrep

## Testing the Vulnerability

⚠️ **WARNING:** Only test in controlled environments!

To test if your application is vulnerable:

```bash
# Install dependencies
bundle install

# Check for vulnerabilities
bundle audit check

# Expected output should show CVE-2016-0752
```

## References

- [CVE-2016-0752 - NVD](https://nvd.nist.gov/vuln/detail/CVE-2016-0752)
- [Rails Security Advisory](https://groups.google.com/g/rubyonrails-security/c/335P1DcLG00)
- [GitHub Advisory](https://github.com/advisories/GHSA-x9xq-9v9q-q9jq)
- [Ruby on Rails Release Notes](https://weblog.rubyonrails.org/2016/1/25/Rails-5-0-0-beta1-1-4-2-5-1-4-1-14-1-3-2-22-1-and-rails-html-sanitizer-1-0-3-have-been-released/)

## Cleanup

This repository is for testing purposes only. Do not deploy these configurations to production environments.

## License

This documentation is for educational and testing purposes only. Use at your own risk.
